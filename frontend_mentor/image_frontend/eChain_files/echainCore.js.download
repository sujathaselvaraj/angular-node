var objectName;var IE4=(document.all&&!document.getElementById)?true:false;var NS4=(document.layers)?true:false;var IE5=(document.all&&document.getElementById)?true:false;var IE9=document.all&&document.getElementById?true:false;var NS6=(document.getElementById&&!document.all)?true:false;var OP=navigator.userAgent.toLowerCase().indexOf("opera")!=-1?1:0;var focusObject;var previousRow;var mainBody;var fixedHead;var floatingHead;var floatingBody;var xMax=window.outerWidth,yMax=window.outerHeight;xOffset=(xMax-200)/2,yOffset=(yMax-200)/2;var selectTarget;var selectTargetText;var selectTimeoutRef;var previousSelectRow;var firstSelectRow;var lastSelectRow;var accountingcurrency;var selectedRef;var onChangeFns=new Array();var autoFillTableObj;var autoFillTname;var popupTarget;var popupMap=new Array();var popupTimeoutRef;var previousTopMenu;var firstTopMenu;var lastTopMenu;var previousMenu;var firstMenu;var lastMenu;var currentMenuType;var currentTopMenu;var currentActiveMenu;var currentSubMenu;var menuKey;var menuTimeoutRef;var menuOut;var goLeft;var afterNumberFormatValue;var headerWhoColumn="";var linesWhoColumn="";var econfigTemplateActive="false";var retailTemplateActive="false";var headerLessTemplateActive="false";var dbMonitorTemplateActive="false";var defaultFunction;var currencyFraction;var tName;var horizontal_offset="9px";var vertical_offset="0";function setHeaderWhocolumn(a){headerWhoColumn=a}function setLinesWhocolumn(a){linesWhoColumn=a}function callauditTranasction(e){if(e.keyCode==113||e.keyCode==27){var finalWhoCoulmnValue="";eventObj=getEvent(e);var target=getTarget(eventObj);var targetName;if(target.name.indexOf(".")!=-1){var fullTargetName=target.name;targetName=document.getElementById(fullTargetName.substring(fullTargetName.lastIndexOf(".")+1,fullTargetName.length))}else{targetName=eval("document.forms[0]."+target.name)}var targetName1=target.name;if(targetName1.indexOf("longtext")!=-1){targetName=eval("document.forms[0]."+targetName1.substring(8,targetName1.length))}if(isNaN(targetName.length)){finalWhoCoulmnValue=eval("document.forms[0]."+headerWhoColumn+".value");}else{var whoColumnValue=eval("document.forms[0]."+linesWhoColumn+"["+getCurrentRowIndex()+"].value");if(whoColumnValue!=""){finalWhoCoulmnValue=whoColumnValue}}if(finalWhoCoulmnValue!=""&&finalWhoCoulmnValue!="0"){document.getElementById("whoColumnIframe").style.display="";var obj=document.getElementById("auditInformation");if(e.keyCode==113){var iframe=top.frames.whoColumnIframe;obj.style.left=document.forms[0].MouseX.value;obj.style.top=document.forms[0].MouseY.value;obj.style.visibility="visible";document.getElementById("whoColumnIframe").style.height="110px";document.getElementById("whoColumnIframe").style.width="290px";document.getElementById("whoColumnIframe").style.visibility="visible";iframe.location.href="/echain/WhoColumnForm.echn?whoColumn="+finalWhoCoulmnValue}else{if(obj.style.visibility=="visible"){obj.style.visibility="hidden"}document.getElementById("whoColumnIframe").style.display="none"}}else{var obj=document.getElementById("auditInformation");if(obj.style.visibility=="visible"){obj.style.visibility="hidden";document.getElementById("whoColumnIframe").style.display="none"}window.status="Sorry, No Audit Info available";return true}}}function find_Browser(){d=document;this.agt=navigator.userAgent.toLowerCase();this.major=parseInt(navigator.appVersion);this.dom=(d.getElementById)?1:0;this.ns=(d.layers);this.ns4up=(this.ns&&this.major>=4);this.ns6=(this.dom&&navigator.appName=="Netscape");this.op=this.agt.indexOf("opera")!=-1;this.ie=(d.all);this.ie4=(d.all&&!this.dom)?1:0;this.ie4up=(this.ie&&this.major>=4);this.ie5=(d.all&&this.dom);this.win=((this.agt.indexOf("win")!=-1)||(this.agt.indexOf("16bit")!=-1));this.mac=(this.agt.indexOf("mac")!=-1)}var oBw=new find_Browser();function ylib_getPageX(o,scroll){if(oBw.ns){var x=(o.pageX)?o.pageX:o.x;return x}else{if(oBw.op){var x=0;while(eval(o)){x+=o.stylo.pixelLeft;e=o.offsetParent}return x}else{var x=0;while(eval(o)){x+=o.offsetLeft;o=o.offsetParent}return x}}}function ylib_getPageY(o,scroll){if(oBw.ns){var y=(o.pageY)?o.pageY:o.y;return y}else{if(oBw.op){var y=0;while(eval(o)){y+=o.stylo.pixelTop;o=o.offsetParent}return y}else{var y=0;while(eval(o)){y+=o.offsetTop;o=o.offsetParent}return y}}}function ylib_getH(b){var a=0;if(oBw.ns){a=(b.height)?b.height:b.clip.height;return a}a=(oBw.op)?b.style.pixelHeight:b.offsetHeight;return a}function ylib_setH(b,a){if(oBw.ns){if(b.clip){b.clip.bottom=a}}else{if(oBw.op){b.style.pixelHeight=a}else{b.style.height=a}}}function ylib_getX(b){var a=(oBw.ns)?b.left:(oBw.op)?b.style.pixelLeft:b.offsetLeft;return a}function ylib_setX(b,a){(oBw.ns)?b.left=a:(oBw.op)?b.style.pixelLeft=a:b.style.left=a}function ylib_getY(a){var b=(oBw.ns)?a.top:(oBw.op)?a.style.pixelTop:a.offsetTop;return b}function ylib_setY(a,b){(oBw.ie||oBw.dom)?a.style.top=b:(oBw.ns)?a.top=b:a.style.pixelTop=b}function ylib_getW(b){var a=0;if(oBw.ns){a=(b.width)?b.width:b.clip.width;return a}a=(oBw.op)?b.style.pixelWidth:b.offsetWidth;return a}function ylib_setW(b,a){if(oBw.ns){if(b.clip){b.clip.right=a}}else{if(oBw.op){b.style.pixelWidth=a}else{b.style.width=a}}}function ylib_writeHTML(c,a){if(oBw.ns){var b=c.document;b.write(a);b.close();return false}if(c.innerHTML){c.innerHTML=a}}function ylib_insertHTML(f,b,a){if(oBw.op){return}if(f.insertAdjacentHTML){f.insertAdjacentHTML(a,b);return}if(oBw.ns){ylib_writeHTML(f,b);return}var c=f.ownerDocument.createRange();c.setStartBefore(f);var g=c.createContextualFragment(b);ylib_insertObj(f,a,g)}function ylib_insertObj(c,a,b){switch(a){case"beforeBegin":c.parentNode.insertBefore(b,c);break;case"afterBegin":c.insertBefore(b,c.firstChild);break;case"beforeEnd":c.appendChild(b);break;case"afterEnd":if(c.nextSibling){c.parentNode.insertBefore(b,c.nextSibling)}else{c.parentNode.appendChild(b)}break}}function setHeaderId(f,b,c,a){mainBody=f;fixedHead=b;floatingHead=c;floatingBody=a}function placeFloatingLayer(){mainBodyObj=document.getElementById(mainBody);if(!mainBodyObj){return}fixedHeadObj=document.getElementById(fixedHead);mainTableObj=getParentElement(fixedHeadObj,"TABLE");floatingHeadObj=document.getElementById(floatingHead);floatingBodyObj=document.getElementById(floatingBody);if(!(mainBodyObj&&fixedHeadObj&&floatingHeadObj&&floatingBodyObj)){return}fixedHeadCols=fixedHeadObj.getElementsByTagName("td");floatingHeadCols=floatingHeadObj.getElementsByTagName("td");if(econfigTemplateActive=="TRUE"||retailTemplateActive=="TRUE"||dbMonitorTemplateActive=="TRUE"){ylib_setX(floatingBodyObj,ylib_getX(mainBodyObj,false));ylib_setY(floatingBodyObj,ylib_getY(mainBodyObj,false))}else{ylib_setY(floatingBodyObj,ylib_getPageY(mainBodyObj,false)-ylib_getPageY(document.getElementById("bodyLayer"),false));ylib_setX(floatingBodyObj,ylib_getPageX(mainBodyObj,false))}ylib_setH(floatingBodyObj,ylib_getH(fixedHeadObj));ylib_setH(floatingHeadObj,ylib_getH(fixedHeadObj));if(ylib_getH(mainBodyObj)<ylib_getH(mainTableObj)){ylib_setW(floatingBodyObj,(ylib_getW(mainBodyObj)-16))}else{ylib_setW(floatingBodyObj,(ylib_getW(mainBodyObj)))}for(var a=0;a<fixedHeadCols.length;a++){ylib_setW(floatingHeadCols[a],ylib_getW(fixedHeadCols[a]))}floatingBodyObj.style.visibility="visible"}function getTableBodyObject(b,a){return b.getElementById(a).getElementsByTagName("tbody")[0]}function createRow(a){var b=a.createElement("tr");return b}function createCell(b){var a=b.createElement("td");return a}function createInput(f,b,c){var a;if(IE4||IE5){a=f.createElement("<input type='"+c+"' name='"+b+"'>")}else{if(OP){a=f.createElement("<input type='"+c+"' name='"+b+"'>")}else{a=f.createElement("input");setAttribute(a,"name",b);setAttribute(a,"type",c)}}return a}function createSelect(c,a){var b;if(IE4||IE5){b=c.createElement("<select name='"+a+"'>")}else{b=c.createElement("select");setAttribute(b,"name",a)}return b}function createOptions(c,f,a){var b;b=c.createElement("option");b.value=f;if(IE4||IE5){b.innerText=a}else{b.innerHTML=a}return b}function createEmptyOptions(c,a){var b=c.createElement("option");b.innerHTML=a;return b}function insertRow(c,b,a){c.appendChild(b);if(!a){setFocus(c,b)}else{if(a.type=="click"){setFocus(c,b)}}}function setFocus(c,b){if(getParentElement(getParentElement(c,"TABLE"),"DIV").style.visibility=="visible"){inputs=b.getElementsByTagName("INPUT");if(isNaN(inputs.length)){return}for(var a=0;a<inputs.length;a++){if(inputs[a].type=="text"&&!inputs[a].readOnly){inputs[a].focus();break}}}}function deleteRow(b,a){b.removeChild(a)}function deleteElement(a,b){a.removeChild(b)}function addCell(b,a){b.appendChild(a)}function addElementTo(a,b){a.appendChild(b)}function setAttribute(element,attrib,val){if(attrib=="class"&&(IE4||IE5)){element.setAttribute("className",val)}else{if(attrib=="style"){eval("element.style."+val+";")}else{if(attrib=="readonly"&&val=="true"){element.setAttribute(attrib,val);if(IE4||IE5){element.readOnly=true}else{element.readOnly=true}}else{if(attrib=="readonly"&&val=="false"){element.removeAttribute("readonly");if(IE4||IE5){element.readOnly=false}else{element.readOnly=false}}else{element.setAttribute(attrib,val)}}}}}function shiftFocus(b){var a=getEvent(b);getTarget(a).value=getTarget(a).value;negateReturnValue(a)}function setEventListener(b,c,a){if(!b||!b.tagName){return}if(IE4||IE5){b.attachEvent("on"+c,a)}else{b.addEventListener(c,a,false)}}function removeEventListener(b,c,a){if(IE4||IE5){b.detachEvent("on"+c,a)}else{b.removeEventListener(c,a,false)}}function getParentElement(b,c){var a=b;if(!a){return a}while(a.tagName.toUpperCase()!=c.toUpperCase()){if(IE4||IE5){a=a.parentElement}else{a=a.parentNode}if(!a||a==document){a=null;break}}return a}function getParentRowElement(b){var a=b;while(a.tagName.toUpperCase()!="TR"){if(IE4||IE5){a=a.parentElement}else{a=a.parentNode}if(!a){break}}return a}function insertTrnMessage(a){}function showAlert(b,a){if((a!=null)){focusObject=a}document.getElementById("MessageCell").innerHTML=b;document.getElementById("ModalLayer").style.left=0;document.getElementById("ModalLayer").style.top=0;document.getElementById("ModalLayer").style.width=document.body.clientWidth;document.getElementById("ModalLayer").style.height=document.body.clientHeight;document.getElementById("AlertLayer").style.top=document.body.scrollTop+(document.body.clientHeight/2)-50;document.getElementById("AlertLayer").style.left=(document.body.clientWidth/2)-200;document.getElementById("ModalLayer").style.visibility="visible";document.getElementById("AlertLayer").style.visibility="visible"}function hideAlert(){document.getElementById("ModalLayer").style.visibility="hidden";document.getElementById("AlertLayer").style.visibility="hidden";doFocus()}function doFocus(){if(focusObject!=null){if(focusObject.tagName!="IMG"&&focusObject.tagName!="A"){focusObject.select()}focusObject.focus()}}function getPreviousSibling(b,c){var a;if(b){do{a=b.previousSibling;if(a){b=a}}while(a&&a.tagName!=c.toUpperCase())}return b}function getFirstChild(c,b){var a;if(c){a=c.getElementsByTagName(b)[0]}return a}function getLastChild(f,b){var c;if(f){var a=f.getElementsByTagName(b).length;c=f.getElementsByTagName(b)[a-1]}return c}function getLengthFor(c,b){var a;if(c){a=c.getElementsByTagName(b).length}return a}function getRowIndex(a){var b;if(a){b=getParentRowElement(a).rowIndex-1}return b}function getNextSibling(a,c){var b;if(a){do{b=a.nextSibling;a=b}while(b.tagName!=c)}return b}function isDownArrowKey(a){if(IE4||IE5){return(event.keyCode==40)}else{return(a.keyCode==40)}}function isUpArrowKey(a){if(IE4||IE5){return(event.keyCode==38)}else{return(a.keyCode==38)}}function isLeftArrowKey(a){if(IE4||IE5){return(event.keyCode==37)}else{return(a.keyCode==37)}}function isRightArrowKey(a){if(IE4||IE5){return(event.keyCode==39)}else{return(a.keyCode==39)}}function isEndKey(a){if(IE4||IE5){return(event.keyCode==35)}else{return(a.keyCode==35)}}function isHomeKey(a){if(IE4||IE5){return(event.keyCode==36)}else{return(a.keyCode==36)}}function isTabKeyWithoutShift(a){if(IE4||IE5){return(!event.shiftKey&&event.keyCode==9)}else{return(!a.shiftKey&&a.keyCode==9)}}function isTabKeyWithShift(a){if(IE4||IE5){return(event.shiftKey&&event.keyCode==9)}else{return(a.shiftKey&&a.keyCode==9)}}function isEnterKey(a){if(IE4||IE5){return(event.keyCode==13)}else{return(a.keyCode==13)}}function isEscKey(a){if(IE4||IE5){return(event.keyCode==27)}else{return(a.keyCode==27)}}function isF9Key(a){if(IE4||IE5){return(event.keyCode==120)}else{return(a.keyCode==120)}}function isF8Key(a){if(IE4||IE5){return(event.keyCode==119)}else{return(a.keyCode==119)}}function isAlphaKey(a){if(IE4||IE5){return(event.keyCode>=65&&event.keyCode<=90)}else{return(a.keyCode>=65&&a.keyCode<=90)}}function isNumKey(a){if(IE4||IE5){return(event.keyCode>=48&&event.keyCode<=57)||(event.keyCode>=96&&event.keyCode<=105)}else{return(a.keyCode>=48&&a.keyCode<=57)||(a.keyCode>=96&&a.keyCode<=105)}}function getEvent(a){if(IE4||IE5){return event}else{return a}}function getEventType(a){if(IE4||IE5){return event.type}else{return a.type}}function getTarget(a){if(popupTarget&&popupTarget.id!="popupTrigger"){return popupTarget}if(IE4||IE5){return event.srcElement}else{return a.target}}function getActualTarget(a){if(IE4||IE5){return event.srcElement}else{return a.target}}function getClickX(a){if(IE4||IE5){return event.x}else{return a.pageX}}function getClickY(a){if(IE4||IE5){return event.y}else{return a.pageY}}function negateReturnValue(e){if(IE4||IE5){event.returnValue=false}else{if(e.stopImmediatePropagation){e.stopImmediatePropagation();}}}function buttonOver(a){btn=document.getElementById(a);row=btn.childNodes[0].childNodes[0];row.childNodes[0].className="btnoverleft";row.childNodes[1].className="btnovermid";row.childNodes[2].className="btnoverright"}function buttonOut(a){btn=document.getElementById(a);row=btn.childNodes[0].childNodes[0];row.childNodes[0].className="btnleft";row.childNodes[1].className="btnmid";row.childNodes[2].className="btnright"}function changeButtonCaption(b,a){btn=document.getElementById(b);row=btn.childNodes[0].childNodes[0];row.childNodes[1].className="btnmid";row.childNodes[1].innerHTML="<FONT class='btn'>"+a+"<FONT>"}function onTabClick(a){tab=document.getElementById(a);activateTab(tab);parentRow=getParentRowElement(tab);for(var b=0;b<getLengthFor(parentRow,"TABLE");b++){var c=parentRow.getElementsByTagName("TABLE")[b];if(c!=tab){inactivateTab(c)}}document.getElementById("PopupImageLayer").style.visibility="hidden"}function activateTab(a){row=a.childNodes[0].childNodes[0];row.childNodes[0].className="tableft";row.childNodes[1].className="tabmid";row.childNodes[1].getElementsByTagName("font")[0].className="tab";row.childNodes[2].className="tabright"}function inactivateTab(a){row=getFirstChild(getFirstChild(a,"TBODY"),"TR");row.getElementsByTagName("TD")[0].className="taboverleft";row.getElementsByTagName("TD")[1].className="tabovermid";row.childNodes[1].getElementsByTagName("font")[0].className="tabover";row.getElementsByTagName("TD")[2].className="taboverright"}function isValidDate(b){var h=/^(\d{1,2})(\/|-)(\d{1,2})\2(\d{2})$/;var c=/^(\d{1,2})(\/|-)(\d{1,2})\2(\d{4})$/;var a=/^(\d{1,2})(\/|-)(\D{3})\2(\d{2})$/;var l=/^(\d{1,2})(\/|-)(\D{3})\2(\d{4})$/;var g=/^(\d{1,2})(\/|-)(\D{3,9})\2(\d{2})$/;var m=/^(\d{1,2})(\/|-)(\D{3,9})\2(\d{4})$/;var j=b.match(datePat);if(j==null){return false}month=j[1];day=j[3];year=j[4];if(month<1||month>12){return false}if(day<1||day>31){return false}if((month==4||month==6||month==9||month==11)&&day==31){return false}if(month==2){var f=(year%4==0&&(year%100!=0||year%400==0));if(day>29||(day==29&&!f)){return false}}return true}function rowIndicator(a){popupTarget=null;eventObj=getEvent(a);if(previousRow){getFirstChild(previousRow,"TD").innerHTML=""}currentTR=getParentRowElement(getTarget(eventObj));popupTarget=getActualTarget(eventObj);indicatorCell=getFirstChild(currentTR,"TD");indicatorCell.innerHTML="&#x25BA;";previousRow=currentTR;placeFloatingLayer()}function getCurrentRowIndex(){if(!previousRow){return 0}return previousRow.rowIndex-1}function getSelectedRadio(a){if(a[0]){for(var b=0;b<a.length;b++){if(a[b].checked){return b}}}else{if(a.checked){return 0}}return -1}function getSelectedRadioValue(a){var b=getSelectedRadio(a);if(b==-1){return""}else{if(a[b]){return a[b].value}else{return a.value}}}function getSelectedCheckbox(a){var f=new Array();var c=0;if(a[0]){for(var b=0;b<a.length;b++){if(a[b].checked){f.length=c;f[c]=b;c++}}}else{if(a.checked){f.length=c;f[c]=0}}return f}function getSelectedCheckboxValue(a){var f=new Array();var c=getSelectedCheckbox(a);if(c.length!=0){f.length=c.length;for(var b=0;b<c.length;b++){if(a[c[b]]){f[b]=a[c[b]].value}else{f[b]=a.value}}}return f}function getSerialNo(a){tblBody=getTableBodyObject(document,a);if(getLengthFor(tblBody,"tr")==0){return 1}else{lastRow=getLastChild(tblBody,"tr");inputElements=lastRow.getElementsByTagName("input");for(var b=0;b<inputElements.length;b++){if(inputElements[b].type=="text"&&inputElements[b].name=="slNo"){return(parseInt(inputElements[b].value)+1)}}}}function NextRowFocus(e){var eventObj=getEvent(e);var rowIndex=getRowIndex(getTarget(eventObj));var rowId=rowIndex;var target=getTarget(eventObj).name;var len=eval("document.forms[0]."+target+".length");if(eventObj.keyCode==40){rowId=rowIndex+1;if(rowId>=len){rowId=0}rowElements=(getParentElement(getTarget(eventObj),"TABLE").getElementsByTagName("TR")[rowId+1]).getElementsByTagName("INPUT");for(var i=0;i<rowElements.length;i++){if(rowElements[i].type=="text"){if(!rowElements[i].readOnly){rowElements[i].focus();break}}}eventObj.returnValue=false}else{if(eventObj.keyCode==38){rowId=rowIndex-1;if(rowId<0){rowId=len-1}rowElements=getParentElement(getTarget(eventObj),"TABLE").getElementsByTagName("TR")[rowId+1].getElementsByTagName("INPUT");for(var i=0;i<rowElements.length;i++){if(rowElements[i].type=="text"){if(!rowElements[i].readOnly){rowElements[i].focus();break}}}eventObj.returnValue=false}}}function clearRow(definefield,defaultArray,checkArray,tabArray){var commitflag=false;if(index==-1){return false}else{if(!previousRow){alert("Select a Line");return false}var index=previousRow.rowIndex-1;for(var x=0;x<tabArray.length;x++){trTag=document.getElementById(tabArray[x]).getElementsByTagName("tr")[index+1];for(var i=2;i<(trTag.getElementsByTagName("td").length);i++){mycell=trTag.getElementsByTagName("td")[i];len=mycell.getElementsByTagName("input").length;for(var j=0;j<len&&commitflag!=true;j++){var textcell=mycell.getElementsByTagName("input")[j].name;if(definefield==""){eval("document.forms[0]."+textcell+"["+index+"].value=''");continue}if(eval("document.forms[0]."+definefield+"["+index+"].value")==0||eval("document.forms[0]."+definefield+"["+index+"].value")==""){if(isNaN(eval("document.forms[0]."+textcell+".length"))){eval("document.forms[0]."+textcell+".value=''")}else{eval("document.forms[0]."+textcell+"["+index+"].value=''")}}else{commitflag=true;alert("Already Committed");return false}}}if(defaultArray.length>0){for(k=0;k<defaultArray[0].length;k++){if(eval("document.forms[0].longtext"+defaultArray[0][k])){longtextObj=eval("document.forms[0].longtext"+defaultArray[0][k]);if(isNaN(longtextObj.length)){longtextObj.value=defaultArray[1][k]}else{longtextObj[index].value=defaultArray[1][k]}}else{if(eval("document.forms[0].cmb_text_"+defaultArray[0][k])){selectObj=eval("document.forms[0].cmb_text_"+defaultArray[0][k]);tableObj=document.getElementById("cmb_table_"+defaultArray[0][k]);hiddenObj=tableObj.getElementsByTagName("INPUT");displayValue="";for(var xx=0;xx<hiddenObj.length;xx++){if(hiddenObj[xx].type=="hidden"&&hiddenObj[xx].name.indexOf("_value")!=-1){if(hiddenObj[xx].value==defaultArray[1][k]){displayValue=hiddenObj[xx+1].value;break}}}if(isNaN(selectObj.length)){selectObj.value=displayValue}else{selectObj[index].value=displayValue}}}eval("document.forms[0]."+defaultArray[0][k]+"["+index+"].value=defaultArray[1][k]")}}if(checkArray.length>0){for(k=0;k<checkArray.length;k++){eval("document.forms[0]."+checkArray[k]+"["+index+"].checked=false")}}}}}function copyTypedContent(eventObj,hiddenName){rowIndex=getRowIndex(eventObj);hiddenObj=eval("document.forms[0]."+hiddenName);if(hiddenObj){if(isNaN(hiddenObj.length)){hiddenObj.value=eventObj.value}else{hiddenObj[rowIndex].value=eventObj.value}}}function copyContentToLongText(rowIndex,objects){if(isNaN(objects.length)){longtextObj=eval("document.forms[0].longtext"+objects);hiddenObj=eval("document.forms[0]."+objects);if(hiddenObj){if(isNaN(hiddenObj.length)){}else{hiddenObj=hiddenObj[rowIndex]}}if(longtextObj){if(isNaN(longtextObj.length)){longtextObj.value=hiddenObj.value}else{if(longtextObj[rowIndex]){longtextObj[rowIndex].value=hiddenObj.value;longtextObj[rowIndex].title=hiddenObj.value}}}else{hiddenObj.title=hiddenObj.value}}else{for(var i=0;i<objects.length;i++){longtextObj=eval("document.forms[0].longtext"+objects[i]);hiddenObj=eval("document.forms[0]."+objects[i]);if(hiddenObj){if(isNaN(hiddenObj.length)){}else{hiddenObj=hiddenObj[rowIndex]}}if(longtextObj){if(isNaN(longtextObj.length)&&rowIndex==0){longtextObj.value=hiddenObj.value}else{if(longtextObj[rowIndex]){longtextObj[rowIndex].value=hiddenObj.value;longtextObj[rowIndex].title=hiddenObj.value}}}else{hiddenObj.title=hiddenObj.value}}}}function isTABKey(a){if(IE4||IE5){return(event.keyCode==9)}else{return(a.keyCode==9)}}function showPopupImage(c){var b=getEvent(c);var f=document.getElementById("PopupImageLayer");popupTarget=getActualTarget(b);parentTarget=getParentElement(popupTarget,"DIV");if(parentTarget&&parentTarget.id=="bodyLayer"){parentTarget=null}var a=ylib_getPageX(popupTarget,true)+ylib_getW(popupTarget)-ylib_getW(f);if(parentTarget){ylib_setX(f,a-parentTarget.scrollLeft);ylib_setY(f,ylib_getPageY(popupTarget,true)-parentTarget.scrollTop-document.getElementById("bodyLayer").scrollTop)}else{ylib_setX(f,a);ylib_setY(f,ylib_getPageY(popupTarget,true)-document.getElementById("bodyLayer").scrollTop)}ylib_setH(f,ylib_getH(popupTarget));f.style.display="";f.style.visibility="visible"}function waitToClick(a){popupTimeoutRef=setTimeout(hidePopupImage,2000)}function clearImageHide(a){clearTimeout(popupTimeoutRef)}function hidePopupImage(a){var b=document.getElementById("PopupImageLayer");b.style.display="none";b.style.visibility="hidden"}function callPopup(e){popupFieldName=popupTarget.name;if(popupFieldName.indexOf("longtext")==0){popupFieldName=popupFieldName.substring(8)}execFn=popupMap[popupFieldName];if(eval(execFn)){execFn(e);popupTarget=document.getElementById("popupTrigger")}}function getPopupTriggerer(a){if(IE4||IE5){return event.srcElement}else{return a.target}}function registerFunction(b,a){popupMap[b]=a}function hideSelectLayer(b){if(selectTarget){var a=document.getElementById("cmb_layer_"+selectTarget.name);a.style.visibility="hidden"}}function setSelectTarget(e){var eventObj=getEvent(e);hideSelectLayer();selectTargetText=getActualTarget(eventObj);if(selectTargetText.name.indexOf("cmb_text_")==-1){return}var selectName=selectTargetText.name.substring(9);selectTarget=eval("document.forms[0]."+selectName+"["+getRowIndex(selectTargetText)+"]");if(!selectTarget){selectTarget=eval("document.forms[0]."+selectName)}document.forms[0].autoFillInput.value=""}function waitToSelect(a){if(a){selectTimeoutRef=setTimeout(hideSelectLayer,a)}else{selectTimeoutRef=setTimeout(hideSelectLayer,2000)}}function clearSelectHide(a){clearTimeout(selectTimeoutRef)}function selectValue(){var doChangeFn;var selectedValue=eval("document.forms[0].cmb_"+previousSelectRow.rowIndex+"_"+selectTarget.name+"_value.value");if(onChangeFns[selectTarget.name]&&selectTarget.value!=selectedValue){doChangeFn=true}selectTarget.value=selectedValue;selectTargetText.value=eval("document.forms[0].cmb_"+previousSelectRow.rowIndex+"_"+selectTarget.name+"_display.value");var selectLayer=document.getElementById("cmb_layer_"+selectTarget.name);selectLayer.style.visibility="hidden";selectTargetText.select();selectTargetText.focus();if(doChangeFn){onChangeFns[selectTarget.name]()}}function changeSelectColor(b,a){if(previousSelectRow){previousSelectRow.className="ComboBG";getFirstChild(previousSelectRow,"A").className="selectBoxNormalFont"}b.className="selectBoxOverFont";selectedRef=getFirstChild(b,"A");selectedRef.className="selectBoxOverFont";b.style.cursor="hand";previousSelectRow=b;selectedRef.focus()}function checkSelectKey(f){if(!selectTarget){setSelectTarget()}if(previousSelectRow){if(isDownArrowKey(f)){if(previousSelectRow==lastSelectRow){changeSelectColor(firstSelectRow)}else{changeSelectColor(getNextSibling(previousSelectRow,"TR"))}}else{if(isUpArrowKey(f)){if(previousSelectRow==firstSelectRow){changeSelectColor(lastSelectRow)}else{changeSelectColor(getPreviousSibling(previousSelectRow,"TR"))}}else{if(isHomeKey(f)){changeSelectColor(firstSelectRow)}else{if(isEndKey(f)){changeSelectColor(lastSelectRow)}else{if(isEnterKey(f)){selectValue()}}}}}}else{var a=selectTarget.name;var b=getTableBodyObject(document,"cmb_table_"+a);var c=b.getElementsByTagName("TR").length;firstSelectRow=b.getElementsByTagName("TR")[0];lastSelectRow=b.getElementsByTagName("TR")[c-1];changeSelectColor(firstSelectRow)}if(isEscKey(f)){hideSelectLayer()}else{if(isTABKey(f)){hideSelectLayer();selectTargetText.focus();return}}negateReturnValue(f)}function setSelectValue(element,selectVal){selectObj=eval("document.forms[0].cmb_text_"+element.name);if(!isNaN(selectObj.length)){selectObj=eval("document.forms[0].cmb_text_"+element.name+"["+getCurrentRowIndex()+"]")}tableObj=document.getElementById("cmb_table_"+element.name);hiddenObj=tableObj.getElementsByTagName("INPUT");displayValue="";for(var x=0;x<hiddenObj.length;x++){if(hiddenObj[x].type=="hidden"&&hiddenObj[x].name.indexOf("_value")!=-1){if(hiddenObj[x].value==selectVal){displayValue=hiddenObj[x+1].value;break}}}selectObj.value=displayValue;element.value=selectVal}function setFirstMatchValue(b){tableObj=document.getElementById("cmb_table_"+selectTarget.name);hiddenObj=tableObj.getElementsByTagName("INPUT");for(var a=0;a<hiddenObj.length;a++){if(hiddenObj[a].type=="hidden"&&hiddenObj[a].name.indexOf("_display")!=-1){if(hiddenObj[a].value.indexOf(b)==0){selectTargetText.value=hiddenObj[a].value;selectTarget.value=hiddenObj[a-1].value;break}}}}function setSelectKeyEvent(a){if(IE4||IE5){setEventListener(a,"keydown",checkSelectKey)}else{setEventListener(a,"keypress",checkSelectKey)}}function setCurrentDate(a){eventObj=getEvent(a);startDateField=getActualTarget(eventObj);if(startDateField&&startDateField.value==""){if(isNaN(startDateField.length)){startDateField.value=document.forms[0].currentDate.value}else{startDateField[getCurrentRowIndex()].value=document.forms[0].currentDate.value}}}function applyCurrentDate(a){if(a){if(isNaN(a.length)){a.value=document.forms[0].currentDate.value}else{a[getCurrentRowIndex()].value=document.forms[0].currentDate.value}}}function getTextLength(g,b){var c=document.createElement("span");c.setAttribute("class",b);var f=document.createTextNode(g);c.appendChild(f);document.body.appendChild(c);var a=c.offsetWidth;document.body.removeChild(c);return a}function Menu(a,c,b){this.menuName=a;this.menuType=c;this.url=b}function openMenuItem(a){refreshFlag="MENU";window.location.href=a}function createTopMenu(b){for(var a=0;a<b.length;a++){if(document.getElementById("top_"+(a+1))){document.getElementById("top_"+(a+1)).innerHTML=b[a]}}}function getSubMenuName(a){return"subMenu_"+a.substring(a.indexOf("_")+1)}function getSubMenuId(a){return"sub_"+a.substring(a.indexOf("_")+1)}function openSubMenu(target){currentActiveMenu=document.getElementById(getSubMenuId(target.id));createSubMenu(target.id,eval(getSubMenuName(target.id)));changeMenuColor(getFirstChild(currentActiveMenu.getElementsByTagName("table")[0],"TR"))}function createSubMenu(l,f){var j=getSubMenuId(l);var h=document.getElementById(j);var o=0;if(currentSubMenu){if(l.indexOf("top_")==0){currentSubMenu.style.visibility="hidden";var g=currentSubMenu.id.split("_");var c=g[0];for(var m=1;m<g.length-1;m++){c=c+"_"+g[m];if(document.getElementById(c)){document.getElementById(c).style.visibility="hidden"}}}else{if(j.indexOf(currentSubMenu.id)==-1){currentSubMenu.style.visibility="hidden";currentParentId=currentSubMenu.id.substring(0,currentSubMenu.id.lastIndexOf("_"));parentId=j.substring(0,j.lastIndexOf("_"));while(currentParentId!=parentId){document.getElementById(currentParentId).style.visibility="hidden";currentParentId=currentParentId.substring(0,currentParentId.lastIndexOf("_"))}}}if(currentSubMenu.id.split("_").length<=2){goLeft=false}}currentSubMenu=h;if(!h){return}if(h.getElementsByTagName("table").length==0){var p="<table cellspacing='0px' cellpadding='0px' width='100%' class='DropdownMenuBG'>";for(var m=0;m<f.length;m++){var b="tr"+j+"_"+(m+1)+"";if(f[m].menuType=="MENUITEM"){p+="<tr height='20px' id='"+b+"' ";p+='onmouseover="changeMenuColor(this, true);" ';p+="onclick=\"openMenuItem('"+f[m].url+"')\">";p+="<td width='100%' class='DropdownMenuFont' nowrap='nowrap'>";p+="<a href=\"javascript:void(0);\" class='MenuHref' ";p+="onfocus=\"currentMenuType='MENUITEM';\">";p+=f[m].menuName}else{p+="<tr height='20px' id='"+b+"' ";p+='onmouseover="changeMenuColor(this, true);">';p+="<td width='100%' class='DropdownMenuFont' nowrap='nowrap'>";p+="<a href=\"#\" class='MenuHref' ";p+="onfocus=\"menuGroupInitialize('"+b+"', '"+f[m].url+"')\" ";p+='onblur="blurMenuGroup();" ';p+="onclick=\"menuGroupInitialize('"+b+"', '"+f[m].url+"')\">";p+=f[m].menuName}p+="</a></td></tr>";var a=getTextLength(f[m].menuName,"MenuHref");if(a>o){o=a}}p+="</table>";ylib_insertHTML(h,p,"afterBegin");var n=document.getElementById(l);h.style.height=f.length*20;if(o>ylib_getW(n)){h.style.width=o+5}else{h.style.width=ylib_getW(n)-2}if(l.indexOf("top_")==0){currentTopMenu=l.substring(l.indexOf("_")+1);h.style.top=ylib_getPageY(n)+ylib_getH(n);h.style.left=ylib_getPageX(n);goLeft=false}else{if((ylib_getPageX(n)+ylib_getW(n)+ylib_getW(h))>window.width||goLeft){h.style.left=ylib_getPageX(n)-ylib_getW(h)+2;goLeft=true}else{h.style.left=ylib_getPageX(n)+ylib_getW(n)+2;goLeft=false}h.style.top=ylib_getPageY(n)}}h.style.visibility="visible"}function initMenuKey(b){var a;if(IE4||IE5){a=event}else{a=b}if(a.altKey){menuKey=true;return}}function openMenu(e){var eventObj;if(IE4||IE5){eventObj=event}else{eventObj=e}if(menuKey==true){if("12345678".indexOf(String.fromCharCode(eventObj.keyCode))!=-1){var topId="top_"+String.fromCharCode(eventObj.keyCode);currentActiveMenu=document.getElementById(getSubMenuId(topId));createSubMenu(topId,eval(getSubMenuName(topId)));changeMenuColor(getFirstChild(currentActiveMenu.getElementsByTagName("table")[0],"TR"))}menuKey=false}else{navigateMenu(e)}negateReturnValue(e)}function changeMenuColor(b,a){if(currentActiveMenu){if(currentActiveMenu.style.visibility=="hidden"){return}}if(previousMenu){currentActiveMenu=getParentElement(b,"DIV");previousMenu.getElementsByTagName("TD")[0].className="DropdownMenuFont";getFirstChild(previousMenu,"A").className="MenuHref"}b.getElementsByTagName("TD")[0].className="DropdownMenuOverFont";selectedRef=getFirstChild(b,"A");selectedRef.className="MenuOverHref";b.style.cursor="hand";previousMenu=b;selectedRef.focus()}function navigateMenu(a){if(previousMenu){totalRows=getParentElement(previousMenu,"TABLE").getElementsByTagName("TR").length;firstMenu=getParentElement(previousMenu,"TABLE").getElementsByTagName("TR")[0];lastMenu=getParentElement(previousMenu,"TABLE").getElementsByTagName("TR")[totalRows-1];if(isDownArrowKey(a)){if(previousMenu==lastMenu){changeMenuColor(firstMenu)}else{changeMenuColor(getNextSibling(getParentRowElement(previousMenu),"TR"))}}else{if(isUpArrowKey(a)){if(previousMenu==firstMenu){changeMenuColor(lastMenu)}else{changeMenuColor(getPreviousSibling(getParentRowElement(previousMenu),"TR"))}}else{if(isRightArrowKey(a)){if(goLeft){navigateRight()}else{navigateRight()}}else{if(isLeftArrowKey(a)){if(goLeft){navigateLeft()}else{navigateLeft()}}else{if(isHomeKey(a)){changeMenuColor(document.getElementById(firstMenu))}else{if(isEndKey(a)){changeMenuColor(document.getElementById(lastMenu))}else{if(isEnterKey(a)){previousMenu.click()}}}}}}}}else{if(currentActiveMenu){changeMenuColor(getFirstChild(currentActiveMenu.getElementsByTagName("table")[0],"TR"))}}if(isEscKey(a)){if(currentActiveMenu){currentActiveMenu.style.visibility="hidden";if(currentActiveMenu.id.split("_").length>2){currentActiveMenu=document.getElementById(currentActiveMenu.id.substring(0,currentActiveMenu.id.lastIndexOf("_")));changeMenuColor(getFirstChild(currentActiveMenu.getElementsByTagName("table")[0],"TR"))}else{if(currentSubMenu){currentSubMenu.style.visibility="hidden"}}}}else{if(isTABKey(a)){return}}negateReturnValue(a)}function blurMenuGroup(){if(currentSubMenu!=currentActiveMenu){if(currentSubMenu.id.split("_").length>2){currentSubMenu.style.visibility="hidden";currentSubMenu=currentActiveMenu}}}function navigateRight(){if(currentMenuType=="MENUGRP"){currentActiveMenu=document.getElementById((currentActiveMenu.id)+"_"+(previousMenu.rowIndex+1));changeMenuColor(getFirstChild(currentActiveMenu.getElementsByTagName("table")[0],"TR"))}else{if(parseInt(currentTopMenu)==topMenu.length){createSubMenu("top_1",eval(getSubMenuName("top_1")));currentActiveMenu=document.getElementById("sub_1")}else{nextMenu=parseInt(currentTopMenu)+1;createSubMenu("top_"+nextMenu,eval(getSubMenuName("top_"+nextMenu)));currentActiveMenu=document.getElementById("sub_"+nextMenu)}changeMenuColor(getFirstChild(currentActiveMenu.getElementsByTagName("table")[0],"TR"))}}function navigateLeft(){if(currentActiveMenu.id.split("_").length>2){parentIndex=(parseInt(currentActiveMenu.id.substring(currentActiveMenu.id.lastIndexOf("_")+1))-1);currentActiveMenu=document.getElementById(currentActiveMenu.id.substring(0,currentActiveMenu.id.lastIndexOf("_")));changeMenuColor(currentActiveMenu.getElementsByTagName("table")[0].getElementsByTagName("TR")[parentIndex])}else{if(parseInt(currentTopMenu)==1){createSubMenu("top_"+topMenu.length,eval(getSubMenuName("top_1")));currentActiveMenu=document.getElementById("sub_"+topMenu.length)}else{prevMenu=parseInt(currentTopMenu)-1;createSubMenu("top_"+prevMenu,eval(getSubMenuName("top_"+prevMenu)));currentActiveMenu=document.getElementById("sub_"+prevMenu)}changeMenuColor(getFirstChild(currentActiveMenu.getElementsByTagName("table")[0],"TR"))}}function closeOpenSubMenu(){}function mouseOverDropdownLayer(){if(menuOut){if(currentActiveMenu.id.indexOf(menuOut)==0||menuOut.indexOf(currentActiveMenu.id)!=-1){clearMenuHide()}}}function mouseOutDropdownLayer(){setMenuHide()}function menuGroupInitialize(menuItemId,subMenuUrl){currentMenuType="MENUGRP";createSubMenu(menuItemId,eval(subMenuUrl))}function setMenuHide(a){menuOut=currentActiveMenu.id;if(a){menuTimeoutRef=setTimeout(hideMenu,a)}else{menuTimeoutRef=setTimeout(hideMenu,2000)}}function clearMenuHide(){if(menuTimeoutRef){clearTimeout(menuTimeoutRef)}}function hideMenu(){var c=currentActiveMenu.id.split("_");var b=c[0];for(var a=1;a<c.length;a++){b=b+"_"+c[a];if(document.getElementById(b)){document.getElementById(b).style.visibility="hidden"}}if(currentSubMenu){currentSubMenu.style.visibility="hidden"}}function formatCurrency(a){eventObj=getEvent(a);DoubleField=getActualTarget(eventObj);if(isNaN(DoubleField.length)){DoubleField.value=navigateCurrencyFormat(DoubleField.value)}else{DoubleField[getCurrentRowIndex()].value=navigateCurrencyFormat(DoubleField[getCurrentRowIndex()].value)}}function FormatClean(c,a){var b="";var f=a;var g="";for(i=0;i<f;i++){g=c.charAt(i);nChar=g.charCodeAt(0);if((nChar>=48)&&(nChar<=57)){b+=c.charAt(i)}}return b}function navigateCurrencyFormat(c){var a="";var g="";var h="";var f="";var b=0;if(digitDelimiter==""){digitDelimiter=","}if(decimalDelimiter==""){decimalDelimiter="."}if(maxFractionDigits==""){maxFractionDigits="2"}c=removeComma(c);c=parseFloat(c);c=new String(c);if(c==""||isNaN(c)){a="";afterNumberFormatValue="";return a}h=decimalDelimiter;if(c.lastIndexOf(h)>0){cents=c.substring(c.lastIndexOf(h)+1,c.length);cents=round("0."+cents,maxFractionDigits);cents=cents.toString();if(cents>=1){b=cents}if(cents==0){cents="00"}else{cents=cents.substring(2,cents.length)}len=c.lastIndexOf(h)}else{cents="00";len=c.length}if(cents.length<maxFractionDigits){condition=maxFractionDigits-cents.length;for(innerLoop=0;innerLoop<condition;innerLoop++){cents=cents+"0"}}if(c.lastIndexOf("-")==0){g="-"}c=FormatClean(c,len);c=parseInt(c)+parseInt(b);if(numberFormat=="LAKHS"||numberFormat=="lakhs"){a=g+c+decimalDelimiter+cents}else{a=g+c+decimalDelimiter+cents}afterNumberFormatValue=a;return a}function FormatMillion(c,a,f){c=parseInt(c)+parseInt(f);var g=new String(c);g=g.substring(0,g.length);for(var b=0;b<Math.floor((g.length-(1+b))/3);b++){g=g.substring(0,g.length-(4*b+3))+a+g.substring(g.length-(4*b+3))}return g}function FormatLakhs(c,a,f){c=parseInt(c)+parseInt(f);var b=3;var g=new String(c);g=g.substring(0,g.length);integerSize=g.length;if(integerSize>3){for(var h=integerSize-3;h>0;h-=2){g=insertNthChar(g,a,h)}}return g}function round(l,p){var b;var f;var j;var c=false;var h=0;var o;var n=l.toString();var m=Math.pow(10,p).toString();var a=Math.round(parseFloat(new BigDecimal(n).multiply(new BigDecimal(m))));var g=Math.pow(10,p);f=a/g;o=f.toString();for(b=0;b<o.length;b++){j=o.charAt(b);if(c==true){h+=parseInt(1)}if(j=="."){c=true}}while((h<p)&&(c==true)){f=o;h+=parseInt("1")}return f}function removeComma(a){return replaceAll(a,digitDelimiter,"")}function replaceAll(b,a,f){var g=0;var c="";while(b.indexOf(a,g)!=-1){c+=b.substring(g,b.indexOf(a,g));c+=f;g=(b.indexOf(a,g)+a.length)}c+=b.substring(g,b.length);return c}function navigateCurrency(c){var a="";var g="";var h="";var f="";var b=0;if(digitDelimiter==""){digitDelimiter=","}if(decimalDelimiter==""){decimalDelimiter="."}if(curencyMaxFractionDigits==""){curencyMaxFractionDigits="2"}if(accountingcurrency!=""&&!isNaN(accountingcurrency)){curencyMaxFractionDigits=accountingcurrency}if(currencyFraction!=""&&!isNaN(currencyFraction)&&currencyFraction!=0){curencyMaxFractionDigits=currencyFraction}c=removeComma(c);c=parseFloat(c);c=new String(c);if(c==""||isNaN(c)){a="";afterNumberFormatValue="";return a}h=decimalDelimiter;if(c.lastIndexOf(h)>0){cents=c.substring(c.lastIndexOf(h)+1,c.length);cents=round("0."+cents,curencyMaxFractionDigits);cents=cents.toString();if(cents>=1){b=cents}if(cents==0){cents="00"}else{cents=cents.substring(2,cents.length)}len=c.lastIndexOf(h)}else{cents="00";len=c.length}if(cents.length<curencyMaxFractionDigits){condition=curencyMaxFractionDigits-cents.length;for(innerLoop=0;innerLoop<condition;innerLoop++){cents=cents+"0"}}if(c.lastIndexOf("-")==0){g="-"}c=FormatClean(c,len);c=parseInt(c)+parseInt(b);if(numberFormat=="LAKHS"||numberFormat=="lakhs"){a=g+c+decimalDelimiter+cents}else{a=g+c+decimalDelimiter+cents}afterNumberFormatValue=a;return a}function CurrencyNavigator(a){eventObj=getEvent(a);DoubleField=getActualTarget(eventObj);if(isNaN(DoubleField.length)){DoubleField.value=navigateCurrency(DoubleField.value)}else{DoubleField[getCurrentRowIndex()].value=navigateCurrency(DoubleField[getCurrentRowIndex()].value)}}function insertNthChar(b,c,f){var a="";a=b.substring(0,f)+c+b.substring(f);return a}function getURLString(a){a=a.replace("%","%25");a=a.replace("&","%26");a=a.replace("'","%27");a=a.replace("=","%3D");a=a.replace('"',"%22");a=a.replace("\\","%5C");a=a.replace("/","%2F");a=a.replace("}","%7D");a=a.replace("{","%7B");return a}function LTrim(g){var b=new String(" \t\n\r");var f=new String(g);if(b.indexOf(f.charAt(0))!=-1){var a=0,c=f.length;while(a<c&&b.indexOf(f.charAt(a))!=-1){a++}f=f.substring(a,c)}return f}function RTrim(f){var a=new String(" \t\n\r");var c=new String(f);if(a.indexOf(c.charAt(c.length-1))!=-1){var b=c.length-1;while(b>=0&&a.indexOf(c.charAt(b))!=-1){b--}c=c.substring(0,b+1)}return c}function Trim(a){return RTrim(LTrim(a))}function setCurrentTime(f,g){var c=new Date();var a=c.getHours();var b=c.getMinutes();if(b<10){b="0"+b}var c=a+":"+b+" ";if(g=="12"){if(a>12){a=a-12;c=c+"PM"}else{c=c+"AM"}}else{if(g=="24"){}}f.value=Trim(c)}function IsValidTime(f,c){if(Trim(f)==""){return true}var a=/^(\d{1,2}):(\d{2})(:(\d{2}))?(\s?(AM|am|PM|pm))?$/;var b=f.match(a);if(b==null){alert("Time is not in a valid format 23:59");return false}hour=b[1];minute=b[2];second=b[4];ampm=b[6];if(second==""){second=null}if(ampm==""){ampm=null}if(hour<0||hour>23){alert("Hour must be between 1 and 12. (or 0 and 23 for military time)");return false}if(hour<=12&&ampm==null){if(c=="12"){alert("You must specify AM or PM.");return false}}if(hour>12&&ampm!=null){alert("You can't specify AM or PM for military time.");return false}if(minute<0||minute>59){alert("Minute must be between 0 and 59.");return false}if(second!=null&&(second<0||second>59)){alert("Second must be between 0 and 59.");return false}return true}function callChangeAccountingCurrency(a){if(a!=""&&!isNaN(a)){accountingcurrency=a}else{accountingcurrency=0}}function getCurrencyFraction(a){if(a!=""&&!isNaN(a)&&a!=0){currencyFraction=a}}function openItemClassPopup(a){mywindow=open("/echain/core/ItemClassSearchForm.echn?autoURL=Y&"+a,"doc","screenX="+xOffset+",screenY="+yOffset+",scrollbars=yes, resizable=yes")}function isF12Key(a){if(IE4||IE5){return(event.keyCode==123)}else{return(a.keyCode==123)}}function copySourceInformation(targetName,targetId){eval("document.forms[0]."+targetName+".value='"+document.forms[0].userSourceName.value+"'");eval("document.forms[0]."+targetId+".value='"+document.forms[0].userSourceId.value+"'")}function setDefaultHRUnit(HRUnitName,HRUnitId){if(eval("document.forms[0]."+HRUnitName).value==""){eval("document.forms[0]."+HRUnitName+".value='"+document.forms[0].defaultHRUnitName.value+"'")}HRUnitIdValue=eval("document.forms[0]."+HRUnitId).value;if(HRUnitIdValue==""||HRUnitIdValue=="0"){eval("document.forms[0]."+HRUnitId+".value='"+document.forms[0].defaultHRUnitId.value+"'")}}function setDefaultFunction(a){defaultFunction=a}function executeDefaultFunction(){eval(defaultFunction+"()")}function emailValidation(h){var a="@";var b=".";var g=h.indexOf(a);var c=h.length;var f=h.indexOf(b);if(h.indexOf(a)==-1){alert("Invalid E-mail ID");return false}if(h.indexOf(a)==-1||h.indexOf(a)==0||h.indexOf(a)==c){alert("Invalid E-mail ID");return false}if(h.indexOf(b)==-1||h.indexOf(b)==0||h.indexOf(b)==c){alert("Invalid E-mail ID");return false}if(h.indexOf(a,(g+1))!=-1){alert("Invalid E-mail ID");return false}if(h.substring(g-1,g)==b||h.substring(g+1,g+2)==b){alert("Invalid E-mail ID");return false}if(h.indexOf(b,(g+2))==-1){alert("Invalid E-mail ID");return false}if(h.indexOf(" ")!=-1){alert("Invalid E-mail ID");return false}return true}function offsetFloatingLayer(a){mainBodyObj=document.getElementById(mainBody);if(!mainBodyObj){return}fixedHeadObj=document.getElementById(fixedHead);mainTableObj=getParentElement(fixedHeadObj,"TABLE");floatingHeadObj=document.getElementById(floatingHead);floatingBodyObj=document.getElementById(floatingBody);if(!(mainBodyObj&&fixedHeadObj&&floatingHeadObj&&floatingBodyObj)){return}fixedHeadCols=fixedHeadObj.getElementsByTagName("td");floatingHeadCols=floatingHeadObj.getElementsByTagName("td");ylib_setY(floatingBodyObj,ylib_getPageY(mainBodyObj,false)-a);floatingBodyObj.style.visibility="visible"}var xmlHttpRequest;function getXMLHttpRequest(){var a=navigator.userAgent.toLowerCase();if(a.indexOf("msie")!=-1){browser="ie"}else{browser="ot"}if(window.ActiveXObject){xmlHttpRequest=new ActiveXObject("Microsoft.XMLHTTP")}else{if(window.XMLHttpRequest){xmlHttpRequest=new XMLHttpRequest();if(xmlHttpRequest.overrideMimeType){xmlHttpRequest.overrideMimeType("text/xml")}}}}function printData(){if(xmlHttpRequest.readyState==4){if(xmlHttpRequest.status==200){var xmlDoc=xmlHttpRequest.responseXML;var root=xmlDoc.getElementsByTagName("GROUP").item(0);eval("delete"+tName+"Table()");if(root.childNodes.length==0){return false}for(var iNode=0;iNode<root.childNodes.length;iNode++){var node=root.childNodes.item(iNode);var arr=new Array(node.childNodes.length);for(i=0;i<node.childNodes.length;i++){var sibl=node.childNodes.item(i);arr[i]=sibl.text}eval("set"+tName+"Table(arr)")}}else{alert("Problem in parsing the XML")}}}function printDataNN(){if(xmlHttpRequest.readyState==4){if(xmlHttpRequest.status==200){var data=xmlHttpRequest.responseXML;var data1=data.getElementsByTagName("GROUP").item(0);var cnt=0;eval("delete"+tName+"Table()");if(data1.childNodes.length==1){return false}for(var iNode=0;iNode<data1.childNodes.length;iNode++){var node=data1.childNodes.item(iNode);if(node.nodeType!=3){tempString="";cnt=0;var nodeLen=parseInt(node.childNodes.length/2);var arr=new Array(nodeLen);for(i=0;i<node.childNodes.length;i++){var sibl=node.childNodes.item(i);if(sibl.nodeType!=3){tempString+=sibl.textContent+"\n";arr[cnt]=sibl.textContent;cnt++}}eval("set"+tName+"Table(arr)")}}}else{alert("Problem in parsing the XML")}}}function highlightSubMenu(b){var a=getTarget(getEvent(b));if(a.tagName=="A"){a=getParentElement(a,"TD")}a.className="highlightSubMenu";document.body.style.cursor="hand"}function defaultSubMenu(b){var a=getTarget(getEvent(b));if(a.tagName=="A"){a=getParentElement(a,"TD")}a.className="defaultSubMenu";document.body.style.cursor="default"}function checkAutofillKey(e){if(previousSelectRow){if(isDownArrowKey(e)){if(previousSelectRow==lastSelectRow){changeSelectColor(firstSelectRow)}else{changeSelectColor(getNextSibling(previousSelectRow,"TR"))}}else{if(isUpArrowKey(e)){if(previousSelectRow==firstSelectRow){changeSelectColor(lastSelectRow)}else{changeSelectColor(getPreviousSibling(previousSelectRow,"TR"))}}else{if(isHomeKey(e)){changeSelectColor(firstSelectRow)}else{if(isEndKey(e)){changeSelectColor(lastSelectRow)}else{if(isEnterKey(e)){eval("set"+autoFillTname+"Data(e)");eval("document.forms[0]."+autoFillTname).focus()}else{if(!isTabKeyWithoutShift(e)){var keyNum;if(IE4||IE5){keyNum=e.keyCode}else{keyNum=e.which}keychar=String.fromCharCode(keyNum);eval("document.forms[0]."+autoFillTname).value=eval("document.forms[0]."+autoFillTname).value+keychar;eval("document.forms[0]."+autoFillTname).focus()}}}}}}}else{var totalRows=autoFillTableObj.getElementsByTagName("TR").length;firstSelectRow=autoFillTableObj.getElementsByTagName("TR")[0];lastSelectRow=autoFillTableObj.getElementsByTagName("TR")[totalRows-1];changeSelectColor(firstSelectRow)}negateReturnValue(e)}function setAutofillKeyEvent(a,c,b){autoFillTableObj=c;autoFillTname=b;if(IE4||IE5){setEventListener(a,"keydown",checkAutofillKey)}else{setEventListener(a,"keypress",checkAutofillKey)}}function placeSelectLayer(g){if(!selectTarget){setSelectTarget(g)}if(getEventType(g)=="keydown"){if(!isDownArrowKey(g)){if(isTABKey(g)){return}else{if(isAlphaKey(g)||isNumKey(g)||g.keyCode==113){document.forms[0].autoFillInput.value+=String.fromCharCode(eventObj.keyCode)}else{if(getEvent(g).keyCode==8){document.forms[0].autoFillInput.value=document.forms[0].autoFillInput.value.substring(0,document.forms[0].autoFillInput.value.length-1)}}}setFirstMatchValue(document.forms[0].autoFillInput.value);negateReturnValue(g);return}}document.forms[0].autoFillInput.value="";var b=document.getElementById("cmb_layer_"+selectTarget.name);var f=0;var a=0;if(IE4||IE5){f=document.body.scrollTop;a=document.body.scrollLeft}else{f=document.body.scrollTop*2;a=document.body.scrollLeft*2}parentLayer=getParentElement(selectTargetText,"DIV");grandParentLayer=getParentElement(getParentElement(selectTargetText,"DIV"),"DIV");if(parentLayer&&parentLayer.id=="bodyLayer"){parentLayer=null}if(grandParentLayer&&grandParentLayer.id=="bodyLayer"){grandParentLayer=null}if(econfigTemplateActive=="TRUE"&&(IE5||IE4)){if(parentLayer){ylib_setX(b,ylib_getPageX(selectTargetText,true)-ylib_getPageX(document.getElementById("main"),true)-parentLayer.scrollLeft);ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText)-ylib_getPageY(document.getElementById("main"),true)-parentLayer.scrollTop)}else{ylib_setX(b,ylib_getPageX(selectTargetText,true));ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText))}}else{if(retailTemplateActive=="TRUE"&&(IE5||IE4)){if(parentLayer){ylib_setX(b,ylib_getPageX(selectTargetText,true)-parentLayer.scrollLeft);ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText)-parentLayer.scrollTop)}else{ylib_setX(b,ylib_getPageX(selectTargetText,true));ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText))}}else{if(grandParentLayer&&grandParentLayer.innerHTML.indexOf("slNo")==-1){if(parentLayer){ylib_setX(b,ylib_getPageX(selectTargetText,true)-ylib_getPageX(grandParentLayer,true)-parentLayer.scrollLeft);ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText)-ylib_getPageY(grandParentLayer,true)-parentLayer.scrollTop)}else{ylib_setX(b,ylib_getPageX(selectTargetText,true)-ylib_getPageX(grandParentLayer,true));ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText)-ylib_getPageY(grandParentLayer,true))}}else{if(parentLayer){ylib_setX(b,ylib_getPageX(selectTargetText,true)-parentLayer.scrollLeft);if(econfigTemplateActive=="TRUE"||headerLessTemplateActive=="TRUE"||retailTemplateActive=="TRUE"){ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText)-parentLayer.scrollTop)}else{ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText)-parentLayer.scrollTop-80)}}else{if(headerLessTemplateActive=="TRUE"){if(IE5||IE4){ylib_setX(b,ylib_getPageX(selectTargetText,true)-10);ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText)-36)}else{ylib_setX(b,ylib_getPageX(selectTargetText,true));ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText)-21)}}else{if(dbMonitorTemplateActive=="TRUE"){if(IE5||IE4){ylib_setX(b,ylib_getPageX(selectTargetText,true)-10);ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText)-136)}else{ylib_setX(b,ylib_getPageX(selectTargetText,true));ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText)-125)}}else{ylib_setX(b,ylib_getPageX(selectTargetText,true));if(retailTemplateActive=="TRUE"){ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText))}else{ylib_setY(b,ylib_getPageY(selectTargetText,true)+ylib_getH(selectTargetText)-80)}}}}}}}ylib_setW(b,ylib_getW(selectTargetText));resultTable=document.getElementById("cmb_table_"+selectTarget.name);var c=resultTable.getElementsByTagName("TR").length;firstSelectRow=resultTable.getElementsByTagName("TR")[0];lastSelectRow=resultTable.getElementsByTagName("TR")[c-1];if((c)<=6){ylib_setH(b,(c)*20)}else{ylib_setH(b,parseInt(document.getElementById("cmb_visible_"+selectTarget.name).value)*20)}if(!getParentElement(selectTargetText,"DIV")){b.style.zIndex="1000"}b.style.visibility="visible";changeSelectColor(firstSelectRow);hidePopupImage()}function getposOffset(f,c){var b=(c=="left")?f.offsetLeft:f.offsetTop;var a=f.offsetParent;while(a!=null){b=(c=="left")?b+a.offsetLeft:b+a.offsetTop;a=a.offsetParent}return b}function iecompattest(){return(document.compatMode&&document.compatMode!="BackCompat")?document.documentElement:document.body}function clearbrowseredge(f,b){var a=(b=="rightedge")?parseInt(horizontal_offset)*-1:parseInt(vertical_offset)*-1;if(b=="rightedge"){var c=IE5&&!window.opera?iecompattest().scrollLeft+iecompattest().clientWidth-30:window.pageXOffset+window.innerWidth-40;dropmenuobj.contentmeasure=dropmenuobj.offsetWidth;if(c-dropmenuobj.x<dropmenuobj.contentmeasure){a=dropmenuobj.contentmeasure+f.offsetWidth+parseInt(horizontal_offset)}}else{var c=IE5&&!window.opera?iecompattest().scrollTop+iecompattest().clientHeight-15:window.pageYOffset+window.innerHeight-18;dropmenuobj.contentmeasure=dropmenuobj.offsetHeight;if(c-dropmenuobj.y<dropmenuobj.contentmeasure){a=dropmenuobj.contentmeasure-f.offsetHeight}}return a}function showhint(c,b,a){if((IE5||NS6)&&document.getElementById("hintbox")){dropmenuobj=document.getElementById("hintbox");dropmenuobj.innerHTML=c;dropmenuobj.style.left=dropmenuobj.style.top=-500;if(a!=""){dropmenuobj.widthobj=dropmenuobj.style;dropmenuobj.widthobj.width=a}getMouseX();dropmenuobj.x=getposOffset(b,"left");dropmenuobj.y=getposOffset(b,"top");dropmenuobj.style.left=document.forms[0].MouseX.value-clearbrowseredge(b,"rightedge")+"px";dropmenuobj.style.top=document.forms[0].MouseY.value-clearbrowseredge(b,"bottomedge")+"px";dropmenuobj.style.visibility="visible";b.onmouseout=hidetip}}function hidetip(a){dropmenuobj.style.visibility="hidden";dropmenuobj.style.left="-500px"}function createhintbox(){var a=document.createElement("div");a.setAttribute("id","hintbox");document.body.appendChild(a)}function getMouseX(){if(IE){tempY=event.clientY+document.body.scrollTop;tempX=event.clientX+document.body.scrollLeft}else{tempY=document.forms[0].MouseY.value;tempX=document.forms[0].MouseX.value}if(tempY<0){tempY=0}if(tempX<0){tempX=0}document.forms[0].MouseY.value=tempY;document.forms[0].MouseX.value=tempX}function getDecimalPlacesLength(a){if(a.indexOf(".")!=-1){a=a.substring(a.indexOf(".")+1,a.length);return a.length}else{return 0}}function getMaxFractionDigits(b){var a=0;for(loop=0;loop<b.length;loop++){if(a<getDecimalPlacesLength(new String(b[loop]))){a=getDecimalPlacesLength(new String(b[loop]))}}return a}function navigateCurrencyWithFactor(c,b){var a=curencyMaxFractionDigits;callChangeAccountingCurrency(b);navigateCurrency(c);callChangeAccountingCurrency(a);return afterNumberFormatValue}function formatExponenttoString(a){if(a.value!=""){if(isNaN(parseFloat(a.value))){a.value=""}else{a.value=new String(parseFloat(a.value))}}return a.value}function validateIntegerValue(e){eventObj=getEvent(e);validatingObject=getActualTarget(eventObj);if(validatingObject&&validatingObject.value!=''){if(isNaN(validatingObject.value)){alert("Invalid Number Format");validatingObject.value='';validatingObject.focus();}else{if(validatingObject.value.indexOf('.')!=-1){alert("Decimal value is not allowed");validatingObject.value='';validatingObject.focus();}}}}function validateNumber(e){eventObj=getEvent(e);validatingObject=getActualTarget(eventObj);if(validatingObject&&validatingObject.value!=''){if(isNaN(validatingObject.value)){alert("Invalid Number Format");validatingObject.value='';validatingObject.focus();return false;}}}function validateDouble(e){eventObj=getEvent(e);validatingObject=getActualTarget(eventObj);if(validatingObject&&validatingObject.value!=''){if(isNaN(validatingObject.value)){alert("Invalid Number Format");validatingObject.value='';validatingObject.focus();return false;}else{if(validatingObject.value.indexOf('.')==-1){alert('Invalid Decimal Format');validatingObject.value='';validatingObject.focus();return false;}}}}function isGreaterThanZero(e){eventObj=getEvent(e);validatingObject=getActualTarget(eventObj);if(validatingObject&&validatingObject.value!=''){if(isNaN(validatingObject.value)){alert("Invalid Number Format");validatingObject.value='';validatingObject.focus();}else{if(validatingObject.value.indexOf('.')!=-1){alert("Decimal value is not allowed");validatingObject.value='';validatingObject.focus();}if(validatingObject.value<=0){alert("Please enter the value");validatingObject.value='';validatingObject.focus();}}}}function isGreaterThanZeroWithDecimal(e){eventObj=getEvent(e);validatingObject=getActualTarget(eventObj);if(validatingObject && validatingObject.value != ''){if(isNaN(validatingObject.value)){alert("Invalid Number Format");validatingObject.value='';validatingObject.focus();}else{if(validatingObject.value<=0){alert("Please enter the value");validatingObject.value='';validatingObject.focus();}}}}function compareDateGreater(e,t){var n=e;var r=t;n=n.replace("-"," ");n=n.replace("-"," ");r=r.replace("-"," ");r=r.replace("-"," ");giveDateValue=new Date(n);compareDateValue=new Date(r);if(giveDateValue>compareDateValue){return true}else{return false}}function compareDateLesser(e,t){var n=e;var r=t;n=n.replace("-"," ");n=n.replace("-"," ");r=r.replace("-"," ");r=r.replace("-"," ");giveDateValue=new Date(n);compareDateValue=new Date(r);if(giveDateValue<compareDateValue){return true}else{return false}}function compareDateEqual(e,t){var n=e;var r=t;n=n.replace("-"," ");n=n.replace("-"," ");r=r.replace("-"," ");r=r.replace("-"," ");giveDateValue=new Date(n);compareDateValue=new Date(r);if(giveDateValue.valueOf()==compareDateValue.valueOf()){return true}else{return false}}function validateAlphabet(e){eventObj=getEvent(e);validatingObject=getActualTarget(eventObj);if(!validatingObject.value.match(/^[a-zA-Z ]+$/)&&validatingObject.value!=""){validatingObject.value="";validatingObject.focus();alert("Please Enter only alphabets value");return false}}function validateAlphanumeric(e){eventObj=getEvent(e);validatingObject=getActualTarget(eventObj);var t=validatingObject.value;for(var n=0;n<t.length;n++){var r=t.charAt(n);var i=r.charCodeAt(0);if(i>47&&i<58||i>64&&i<91||i>96&&i<123){}else{alert("Please Enter only alphanumeric value");validatingObject.value="";validatingObject.focus();return false}}}function compareDateGreaterThanOrEqual(e,t){var n=e;var r=t;n=n.replace("-"," ");n=n.replace("-"," ");r=r.replace("-"," ");r=r.replace("-"," ");giveDateValue=new Date(n);compareDateValue=new Date(r);if(giveDateValue>=compareDateValue){return true}else{return false}}function compareDateLesserThanOrEqual(e,t){var n=e;var r=t;n=n.replace("-"," ");n=n.replace("-"," ");r=r.replace("-"," ");r=r.replace("-"," ");giveDateValue=new Date(n);compareDateValue=new Date(r);if(giveDateValue<=compareDateValue){return true}else{return false}}function myMethod(e,t){if(getEventType(t)=="dblclick"||isF8Key(t)){e(t)}}function setEventListener(e,t,n,r){if(!e||!e.tagName){return}if(IE4||IE5||IE9){if(r){e.attachEvent("on"+t,function(e){myMethod(n,e)})}else{e.attachEvent("on"+t,n)}}else{if(r){e.addEventListener(t,function(e){myMethod(n,e)},false)}else{e.addEventListener(t,n,false)}}}var popupHiddenFieldsObject=[];function addPopupHiddenProperty(popupField,popupHiddenField,displayMessage){var params=new Array(3);params[0]=popupField;params[1]=popupHiddenField;params[2]=displayMessage;popupHiddenFieldsObject[popupField]=params;}function getPopupHiddenProperty(popupField){return popupHiddenFieldsObject[popupField];}function validateHiddenPropertyValue(e){if(popupEnabled=='false'){var eventObj=getEvent(e);validatingObject=getActualTarget(eventObj);objectName=validatingObject.name;var hiddenObject;var hiddenFieldName;var fullTargetName=validatingObject.name;if(fullTargetName.indexOf('.')!=-1){var fullTargetName=fullTargetName.substring(fullTargetName.lastIndexOf('.')+1,fullTargetName.length);hiddenFieldName=getPopupHiddenProperty(fullTargetName);if(hiddenFieldName[1]!=''){hiddenObject=eval('document.forms[0].'+hiddenFieldName[1])}}else if(isNaN(eval("document.forms[0]."+validatingObject.name).length)){hiddenFieldName=getPopupHiddenProperty(validatingObject.name);if(hiddenFieldName[1]!=''){hiddenObject=eval('document.forms[0].'+hiddenFieldName[1])}}else{hiddenFieldName=getPopupHiddenProperty(validatingObject.name);if(hiddenFieldName[1]!=''){hiddenObject=eval('document.forms[0].'+hiddenFieldName[1]+'['+getCurrentRowIndex()+']')}}if(validatingObject.value!=''&&(hiddenObject.value==''||hiddenObject.value=='0')){execFn=popupMap[validatingObject.name];if(eval(execFn)){execFn(e);popupTarget=document.getElementById("popupTrigger")}}}else{var eventObj=getEvent(e);negateReturnValue(eventObj)}disablePopupField();}function validatingHiddenProperty(e){if(popupEnabled=="false"){var hiddenObject;var hiddenFieldName;var fullTargetName=objectName;if(fullTargetName.indexOf(".")!=-1){var fullTargetName=fullTargetName.substring(fullTargetName.lastIndexOf(".")+1,fullTargetName.length);hiddenFieldName=getPopupHiddenProperty(fullTargetName);if(hiddenFieldName[1]!=""){hiddenObject=eval("document.forms[0]."+hiddenFieldName[1])}}else if(isNaN(eval("document.forms[0]."+validatingObject.name).length)){hiddenFieldName=getPopupHiddenProperty(validatingObject.name);if(hiddenFieldName[1]!=""){hiddenObject=eval("document.forms[0]."+hiddenFieldName[1])}}else{hiddenFieldName=getPopupHiddenProperty(validatingObject.name);if(hiddenFieldName[1]!=""){hiddenObject=eval("document.forms[0]."+hiddenFieldName[1]+"["+getCurrentRowIndex()+"]")}}if(validatingObject.value!=""&&(hiddenObject.value==""||hiddenObject.value=="0")){if(hiddenObject.value==""||hiddenObject.value=="0"){window.parent.alert("Select "+hiddenFieldName[2]+" from popup");validatingObject.value="";validatingObject.focus();return false}}}else{var eventObj=getEvent(e);negateReturnValue(eventObj)}disablePopupField()}function isGreaterThanOrEqualZeroWithDecimal(e){eventObj=getEvent(e);validatingObject=getActualTarget(eventObj);if(validatingObject&&validatingObject.value!=""){if(isNaN(validatingObject.value)){alert("Invalid Number Format");validatingObject.value="";validatingObject.focus()}else{if(validatingObject.value*1<0){alert("Please Enter the value");validatingObject.value="";validatingObject.focus()}}}};